# سفر قهرمان حافظه – راز معبد جادویی

**Ali Rashidi**  
[Telegram: t.me/WriteYourWay](https://t.me/WriteYourWay)

---

## معرفی پروژه

در این پروژه، شما در نقش آریا، جوانی شجاع با مأموریتی بزرگ به دنیای اسرارآمیز معبد جادویی قدم می‌گذارید.  
افسانه‌ها می‌گویند که در اعماق معبدی باستانی، رمز و رازی نهفته است که می‌تواند سرنوشت جهان را تغییر دهد. تنها راه ورود به معبد، حل معمای دنباله‌های جادویی است.  
آریا برای این ماجراجویی از ابزارهای ویژه‌ای بهره می‌برد:

- **کیپد 4×4 جادویی:** نمایش نمادهای باستانی و رونو‌های اسرارآمیز.
- **جوی‌استیک جهت‌دار:** ارائه حرکات جهت‌دار (بالا، پایین، چپ، راست و فشردن مرکز) به عنوان راهنمایی‌های جادویی.
- **بوزر جادویی:** پخش صداهایی که موفقیت یا هشدار در مسیر ماجراجویی را اعلام می‌کند.
- **LCD 2×16:** نمایش پیام‌های رمزی و داستانی معماهای معبد.

---

## داستان پروژه

### **عنوان: سفر قهرمان حافظه – راز معبد جادویی**

#### **بخش ۱: ورود به معبد اسرارآمیز**
در روزگاران دور، آریا پس از طی کردن سفرهای خطرناک و پرماجرا به دروازه سنگی معبد باستانی می‌رسد. روی دروازه، یک صفحه‌ی LCD پیام زیر را به نمایش می‌گذارد:
> "راز آغاز ماجرای تو در دنباله‌های جادویی نهفته است؛ تنها قهرمانی که بتواند این رمز را درک کند، دروازه‌ها را بگشاید."
عملکرد:  
با استفاده از جوی‌استیک، آریا بین گزینه‌های "شروع ماجراجویی"، "آموزش رموز"، "آمار شجاعت" (Score) و "حالت تست" (Test Mode) جابجا شده و انتخاب نهایی را با فشردن CENTER تایید می‌کند.

#### **بخش ۲: دنباله‌های جادویی معبد**
پس از ورود به معبد، صدای بوزر و نمایش دنباله‌ای از نمادهای جادویی آغاز می‌شود.  
بعضی از این نمادها از طریق کیپد (مانند یک رونه‌ی آبی) و برخی از طریق جوی‌استیک (حرکات جهت‌دار) ارائه می‌شوند.  
عملکرد:  
- آریا باید دنباله نمایش داده شده را با دقت تکرار کند.
- هر سیگنال توسط بوزر با صدای خاص خود همراه است.

#### **بخش ۳: چالش‌های زمانی و نیروهای تاریک**
در میانه ماجراجویی، نیروهای تاریکی ظاهر می‌شوند؛ زمان پاسخ‌دهی به دنباله‌ها کاهش می‌یابد و هشدارهای صوتی و تصویری (مثل نمایش ساعت شنی) از LCD و بوزر به صدا درمی‌آید.  
عملکرد:  
- زمان‌بندی هر مرحله به‌صورت محدود تعیین شده است.
- در صورت عدم پاسخ‌دهی به موقع یا خطا، پیام "خطا! نیروهای تاریک در حال نزدیک شدن‌اند" نمایش داده می‌شود.

#### **بخش ۴: مراحل ویژه و رمزگشایی معما**
با پیشروی آریا در معبد، الگوها گاهی به صورت معکوس یا ترکیبی از حرکات کیپد و جوی‌استیک نمایش داده می‌شوند.  
عملکرد:  
- الگوهای معکوس: برخی مراحل، از آریا خواسته می‌شود الگو را به ترتیب معکوس وارد کند.
- چالش ترکیبی: حرکات همزمان از کیپد و جوی‌استیک، سطح چالش را بالا می‌برد.
- پس از عبور هر مرحله، پیام‌هایی مانند "شجاعت تو، تاریکی را شکست داد" نمایش داده می‌شود.

#### **بخش ۵: نبرد نهایی و کشف راز**
در اتاق نهایی معبد، دنباله‌ای نهایی و بسیار پیچیده نمایش داده می‌شود که آزمون نهایی آریا است.  
عملکرد:  
- آریا باید دنباله نهایی را تکرار کند تا دروازه معبد باز شود.
- در صورت موفقیت، پیام "قهرمان حافظه – راز معبد برای تو آشکار شد" نمایش داده می‌شود.

#### **بخش ۶: بازخورد لمسی و پایان ماجراجویی**
در لحظات حساس، بازخوردهای لمسی (در صورت وجود) مانند لرزش کوتاه همراه با صدای هشدار به آریا اطلاع می‌دهد که اشتباه کرده یا زمان به پایان رسیده است.  
نتیجه نهایی:  
با عبور موفقیت‌آمیز از تمامی مراحل و حل معماهای جادویی، آریا راز معبد را کشف کرده و به عنوان قهرمان حافظه و شجاعت شناخته می‌شود.

---

## ویژگی‌های اصلی

- **بازی حافظه تعاملی:** تکرار الگوهای جادویی با استفاده از کیپد و جوی‌استیک.
- **حالت‌های ویژه:** شامل حالت معکوس هر 5 سطح، چالش‌های ترکیبی و محدودیت‌های زمانی.
- **بازخورد صوتی و (در صورت امکان) لمسی:** بوزر برای اعلام موفقیت و هشدار، و (در صورت پشتیبانی سخت‌افزاری) موتور لرزش.
- **ذخیره‌سازی امتیاز:** امتیاز نهایی در فایل `score.txt` ذخیره می‌شود.
- **حالت تست:** امکان بررسی عملکرد ورودی‌های کیپد و جوی‌استیک برای عیب‌یابی.

---

## نیازمندی‌های سخت‌افزاری

- **میکروکنترلر:** دستگاه‌های سازگار با MicroPython (مانند Raspberry Pi Pico)
- **کیپد 4×4 (ماتریسی)**
- **جوی‌استیک:** شامل دو ورودی آنالوگ برای محورهای X و Y و یک دکمه CENTER (با Pull-Up)
- **LCD I2C:** صفحه نمایش 2×16 با ماژول I2C
- **بوزر:** جهت پخش صدا (با استفاده از PWM)
- **سیم‌ها و برد آزمایش**

---

## نیازمندی‌های نرم‌افزاری

- **MicroPython:** برای اجرای کد بر روی میکروکنترلر
- **uasyncio:** برای برنامه‌نویسی غیرهمزمان
- **کتابخانه i2c_lcd:** جهت کنترل LCD از طریق I2C

---

## نحوه اتصال سخت‌افزاری

- **کیپد 4×4:** پین‌های ردیف (مثلاً 2، 3، 4، 5) به عنوان خروجی و پین‌های ستون (مثلاً 6، 7، 8، 9) به عنوان ورودی (با Pull-Down) به میکروکنترلر متصل می‌شوند.
- **جوی‌استیک:** پین‌های آنالوگ (مثلاً 26 و 27) برای خواندن محورهای X و Y و یک پین دیجیتال (مثلاً 22) به عنوان دکمه CENTER (با Pull-Up) استفاده می‌شود.
- **LCD I2C:** پین‌های I2C (SCL بر روی پین 17 و SDA بر روی پین 16) به LCD متصل می‌شوند.
- **بوزر:** به پین 15 متصل شده و از PWM جهت تولید صدا استفاده می‌شود.

---

## نحوه اجرای پروژه

1. **آپلود کد:** فایل کد (مثلاً `main.py`) را بر روی میکروکنترلر خود آپلود کنید.
2. **روشن کردن دستگاه:** پس از آپلود، دستگاه را روشن کنید.
3. **نمایش منوی اصلی:**  
   در منوی اصلی، گزینه‌های زیر موجود هستند (گزینه خروج حذف شده است):
   - **Start Adventure (شروع ماجراجویی):** آغاز بازی حافظه.
   - **Instructions (آموزش رموز):** مشاهده دستورالعمل‌ها.
   - **Test Mode (حالت تست):** بررسی عملکرد ورودی‌های کیپد و جوی‌استیک.
   - **Score (آمار شجاعت):** نمایش آخرین امتیاز ذخیره‌شده.
4. **بازی:** پس از انتخاب "Start Adventure"، بازی آغاز می‌شود؛ آریا باید دنباله‌های جادویی نمایش داده شده را تکرار کند.
5. **ذخیره امتیاز:** پس از پایان بازی (زمانی که زندگی‌ها به پایان می‌رسد)، امتیاز نهایی در فایل `score.txt` ذخیره می‌شود.

---

## ساختار کد

کد پروژه به بخش‌های زیر تقسیم می‌شود:

- **توابع save_score(score) و load_score():**  
  ذخیره و بارگذاری امتیاز بازی از فایل.

- **کلاس Keypad:**  
  مدیریت ورودی‌های کیپد 4×4 جهت تشخیص کلیدهای فشرده شده.

- **کلاس Joystick:**  
  دریافت جهت حرکت یا فشردن CENTER از جوی‌استیک.

- **کلاس Buzzer:**  
  کنترل بوزر جهت پخش صدا با استفاده از PWM.

- **تابع replay_pattern(seq, lcd, buzzer, extra_delay):**  
  بازپخش دنباله فعلی روی LCD با تأخیر افزایشی جهت کمک به بازیکن.

- **تابع get_player_input(expected_seq, lcd, keypad, joystick, buzzer, time_limit):**  
  دریافت ورودی کاربر برای تطبیق با الگوی نمایش داده شده؛ در صورت فشردن "*" تمامی ورودی‌های قبلی پاک شده و از ابتدا آغاز می‌شود.

- **تابع play_sequence(lcd, keypad, joystick, buzzer):**  
  اجرای بازی شامل نمایش دنباله‌های جادویی، دریافت ورودی کاربر و به‌روزرسانی وضعیت بازی (سطح، امتیاز، زندگی).

- **تابع test_mode(lcd, keypad, joystick, buzzer):**  
  حالت تست جهت بررسی عملکرد ورودی‌های کیپد و جوی‌استیک.

- **تابع game_adventure(lcd, keypad, joystick, buzzer):**  
  اجرای ماجراجویی بازی شامل پیام‌های داستانی (مانند "Temple Gate") و شروع بازی.

- **تابع main_menu():**  
  نمایش منوی اصلی جهت انتخاب گزینه‌های بازی (گزینه "Exit" حذف شده است).

- **تابع main():**  
  حلقه اصلی اجرای منو به صورت مداوم.

---

## نکات مهم

- **داستان و تجربه داستانی:**  
  این بازی همراه با داستانی جذاب و پر رمز و راز طراحی شده است تا تجربه‌ای فراتر از یک معمای ساده برای بازیکن ایجاد کند.

- **حذف گزینه خروج:**  
  در منوی اصلی، گزینه "Exit" حذف شده است تا بازی به صورت مداوم منو را نمایش دهد.

- **تنظیمات زمانی و penalty:**  
  در صورت فشردن کلید "*" برای بازپخش الگو، ورودی‌های قبلی پاک شده و penalty معینی اعمال می‌شود.

- **حالت معکوس:**  
  هر 5 سطح، الگو به صورت معکوس نمایش داده می‌شود تا چالش بیشتری ایجاد کند.

- **پشتیبانی از چندین ورودی:**  
  ورودی‌های کیپد و جوی‌استیک به‌صورت همزمان در پروژه مدیریت می‌شوند.

---

## تماس و پشتیبانی

برای دریافت اطلاعات بیشتر، گزارش اشکال یا پیشنهادات می‌توانید با **Ali Rashidi** از طریق [Telegram](https://t.me/WriteYourWay) تماس بگیرید.

---

## مجوز

این پروژه به عنوان یک منبع باز عرضه شده است و شما می‌توانید آن را تغییر داده و مجدداً توزیع نمایید.

---

## فایل‌های اصلی

- **main.py:**  
  شامل کد اصلی بازی به همراه توابع، کلاس‌ها و منطق داستانی.
- **score.txt:**  
  فایلی جهت ذخیره امتیاز نهایی بازی.

---

## نتیجه‌گیری

این بازی ترکیبی از چالش‌های حافظه، داستانی جذاب و تجربه‌ای تعاملی است که بازیکن را به دنیای جادویی معبد می‌برد. با تکرار الگوهای جادویی، مدیریت زمان و واکنش به ورودی‌های حسی، آریا (و در نتیجه بازیکن) باید به رازهای معبد پی ببرد و قهرمان حافظه شود.

